(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[547],{7681:(e,t,s)=>{Promise.resolve().then(s.bind(s,44))},44:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(5155),n=s(2115);function a(){let[e,t]=(0,n.useState)("upcoming"),[s,a]=(0,n.useState)({upcoming:[],past:[]}),[i,o]=(0,n.useState)(!0),[l,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(null),[m,x]=(0,n.useState)(null),p=async()=>{try{let e=localStorage.getItem("authToken");if(!e)throw Error("Token d'authentification manquant");let t=await fetch("/api/profile",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("Erreur lors du chargement du profil");let s=await t.json();if(s.success&&s.data&&s.data._id)return x(s.data.userId),s.data.userId;throw Error("Impossible de r\xe9cup\xe9rer l'ID utilisateur")}catch(e){throw console.error("Erreur lors du chargement du profil:",e),e}},h=async()=>{try{o(!0),c("");let e=localStorage.getItem("authToken");if(!e)throw Error("Token d'authentification manquant");let t=await p(),s=await fetch("/api/events",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!s.ok)throw Error("Erreur lors du chargement des \xe9v\xe9nements");let r=await s.json();if(r.success){let e=new Date,s=[],n=[];r.data.events.forEach(r=>{var a;let i=new Date(r.startDate),o=null===(a=r.participants)||void 0===a?void 0:a.includes(t);i>=e?s.push({...r,status:o?"registered":"available",type:g(r)}):n.push({...r,status:"completed",type:g(r)})}),a({upcoming:s,past:n})}else throw Error(r.message||"Erreur lors du chargement des \xe9v\xe9nements")}catch(e){console.error("Erreur:",e),c(e.message),a({upcoming:[{_id:"1",title:"Congr\xe8s Annuel de Cosm\xe9tologie",startDate:"2024-09-15T09:00:00Z",location:"Paris, France",type:"congress",status:"available",description:"Le plus grand rassemblement de professionnels de la cosm\xe9tologie en France.",isOnline:!1,isMemberOnly:!1,participants:[]},{_id:"2",title:"Atelier Formulation Naturelle",startDate:"2024-10-05T14:00:00Z",location:"Lyon, France",type:"workshop",status:"available",description:"Apprenez \xe0 formuler des produits cosm\xe9tiques avec des ingr\xe9dients naturels.",isOnline:!1,isMemberOnly:!0,participants:[]}],past:[{_id:"3",title:"Webinaire R\xe9glementation",startDate:"2024-05-12T10:00:00Z",location:"En ligne",type:"webinar",status:"completed",description:"Tout savoir sur les nouvelles r\xe9glementations cosm\xe9tiques en 2024.",isOnline:!0,isMemberOnly:!1,participants:[]}]})}finally{o(!1)}},g=e=>{var t,s,r,n,a;return e.isOnline?"webinar":(null===(t=e.title)||void 0===t?void 0:t.toLowerCase().includes("congr\xe8s"))||(null===(s=e.title)||void 0===s?void 0:s.toLowerCase().includes("congres"))?"congress":(null===(r=e.title)||void 0===r?void 0:r.toLowerCase().includes("atelier"))||(null===(n=e.title)||void 0===n?void 0:n.toLowerCase().includes("workshop"))||(null===(a=e.title)||void 0===a?void 0:a.toLowerCase().includes("formation"))?"workshop":"congress"};(0,n.useEffect)(()=>{h()},[]);let b=e=>{switch(e){case"registered":return{text:"Inscrit",color:"bg-green-100 text-green-800"};case"available":return{text:"Disponible",color:"bg-blue-100 text-blue-800"};case"pending":return{text:"En attente",color:"bg-yellow-100 text-yellow-800"};case"completed":return{text:"Termin\xe9",color:"bg-gray-100 text-gray-800"};default:return{text:e,color:"bg-gray-100 text-gray-800"}}},v=e=>{switch(e){case"congress":return"\uD83C\uDFA4";case"workshop":return"\uD83D\uDD2C";case"webinar":return"\uD83D\uDCBB";default:return"\uD83D\uDCC5"}},f=e=>new Date(e).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=async e=>{try{u(e);let t=localStorage.getItem("authToken");if(!t)throw Error("Token d'authentification manquant");let s=m;s||(s=await p()),console.log("Inscription \xe0 l'\xe9v\xe9nement:",e),console.log("User ID:",s),console.log("Token:",t);let r=await fetch("/api/events/".concat(e,"/register"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)}}),n=await r.json();if(console.log("R\xe9ponse de l'API:",n),!r.ok)throw Error(n.message||"Erreur lors de l'inscription");if(n.success)a(t=>({...t,upcoming:t.upcoming.map(t=>t._id===e?{...t,status:"registered",participants:[...t.participants||[],s]}:t)})),alert("✅ Inscription r\xe9ussie ! Vous \xeates maintenant inscrit \xe0 cet \xe9v\xe9nement.");else throw Error(n.message||"Erreur lors de l'inscription")}catch(e){console.error("Erreur:",e),alert("❌ Erreur: ".concat(e.message))}finally{u(null)}},w=e=>{var t;let s=y(e),r=(null===(t=e.participants)||void 0===t?void 0:t.length)||0,n=e.maxParticipants||"Illimit\xe9";alert("D\xe9tails de l'\xe9v\xe9nement:\n\n"+"\uD83D\uDCCC ".concat(e.title,"\n\n")+"\uD83D\uDCDD ".concat(e.description||"Aucune description","\n\n")+"\uD83D\uDCC5 Date: ".concat(f(e.startDate),"\n")+"\uD83D\uDCCD Lieu: ".concat(e.location,"\n")+"\uD83D\uDC65 Participants: ".concat(r,"/").concat(n,"\n")+"\uD83D\uDCB0 Prix membre: ".concat(e.memberPrice||0,"DA\n")+"\uD83D\uDCB0 Prix non-membre: ".concat(e.nonMemberPrice||0,"DA\n")+"".concat(e.isOnline?"\uD83D\uDCBB \xc9v\xe9nement en ligne":"\uD83C\uDFE2 \xc9v\xe9nement pr\xe9sentiel","\n")+"".concat(e.isMemberOnly?"\uD83D\uDD12 R\xe9serv\xe9 aux membres":"\uD83D\uDD13 Ouvert \xe0 tous","\n")+"".concat(s?"✅ Vous \xeates inscrit \xe0 cet \xe9v\xe9nement":"❌ Vous n'\xeates pas inscrit"))},y=e=>{var t;return!!m&&(null===(t=e.participants)||void 0===t?void 0:t.includes(m))};return i?(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"\xc9v\xe9nements"})}),(0,r.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Chargement des \xe9v\xe9nements..."})]})})]}):(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"\xc9v\xe9nements"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"D\xe9couvrez tous nos \xe9v\xe9nements et formations"})]}),(0,r.jsxs)("button",{onClick:h,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,r.jsx)("span",{children:"Actualiser"})]})]}),l&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:l})]})}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"border-b border-gray-200",children:(0,r.jsxs)("nav",{className:"flex -mb-px",children:[(0,r.jsxs)("button",{onClick:()=>t("upcoming"),className:"py-4 px-6 text-center font-medium text-sm ".concat("upcoming"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:["\xc0 venir (",s.upcoming.length,")"]}),(0,r.jsxs)("button",{onClick:()=>t("past"),className:"py-4 px-6 text-center font-medium text-sm ".concat("past"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:["Pass\xe9s (",s.past.length,")"]})]})}),(0,r.jsx)("div",{className:"p-6",children:0===s[e].length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCC5"}),(0,r.jsxs)("p",{className:"text-gray-600 text-lg mb-2",children:["Aucun \xe9v\xe9nement ","upcoming"===e?"\xe0 venir":"pass\xe9"]}),(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"upcoming"===e?"Revenez plus tard pour d\xe9couvrir nos prochains \xe9v\xe9nements":"Aucun \xe9v\xe9nement pass\xe9 pour le moment"})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s[e].map(t=>{var s;let n=y(t),a=b(n?"registered":t.status),i=d===t._id,o=(null===(s=t.participants)||void 0===s?void 0:s.length)||0,l=t.maxParticipants||"Illimit\xe9";return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsx)("div",{className:"text-2xl",children:v(t.type)}),(0,r.jsxs)("div",{className:"flex flex-col items-end space-y-1",children:[(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(a.color),children:a.text}),t.isMemberOnly&&(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"Membres"}),t.isOnline&&(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"En ligne"})]})]}),(0,r.jsx)("h3",{className:"font-semibold text-lg mb-2 line-clamp-2",children:t.title}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:t.description||"Description non disponible"}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,r.jsxs)("span",{children:[o,"/",l," participants"]})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("span",{className:"truncate",children:f(t.startDate)})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-4",children:[(0,r.jsxs)("svg",{className:"w-4 h-4 mr-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,r.jsx)("span",{className:"truncate",children:t.location})]}),"upcoming"===e&&(0,r.jsxs)("div",{className:"flex space-x-2",children:[n?(0,r.jsxs)("button",{className:"flex-1 py-2 bg-green-600 text-white rounded-md text-sm flex items-center justify-center",disabled:!0,children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Inscrit"]}):(0,r.jsx)("button",{onClick:()=>j(t._id),disabled:i,className:"flex-1 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-sm flex items-center justify-center",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Inscription..."]}):"S'inscrire"}),(0,r.jsx)("button",{onClick:()=>w(t),className:"px-3 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 text-sm",children:"D\xe9tails"})]}),"past"===e&&(0,r.jsx)("button",{onClick:()=>w(t),className:"w-full py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 text-sm",children:"Voir les d\xe9tails"})]},t._id)})})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(7681)),_N_E=e.O()}]);